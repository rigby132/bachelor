\section{Hartree-Fock}
\subsection{Energie}
Wir betrachten zuerst die Energie, die wir minimieren möchten.
Diese kombinieren wir dann mit unserer Darstellung 
der Gesamt\-/Wellenfunktion \cref{slater}:
\begin{flalign}
  E_\textrm{HF}[\Psi] 
    &= \langle \Psi \vert \hat{H}_{\text{el}} \vert \Psi \rangle \nonumber\\ 
    &= \langle \Psi \vert \hat{H}_{\text{core}} + \hat{V}_{ee} \vert \Psi \rangle \nonumber\\
    &= \langle \Psi \vert \hat{H}_{\text{core}} \vert \Psi \rangle 
    + \langle \Psi \vert \hat{V}_{ee} \vert \Psi \rangle &\vert \textrm{ Slater-Condon-Regel} \nonumber\\
    &= \sum_i^{2n} \langle \varphi_i \vert \hat{H}_{\text{core}} \vert \varphi_i \rangle
      + \frac{1}{2} \sum_{i, j}^{2n} \left( 
      \left[ \varphi_i \varphi_i \vert \varphi_j\varphi_j \right] 
      - \left[ \varphi_i\varphi_j \vert \varphi_j\varphi_i \right]
      \right)
\end{flalign}

\cite[S. 235, S.253]{atkins_friedman_2011}

%================================================
%2-ELEKTRONEN-INTEGRALE
%================================================
\subsection{2\-/Elektronen\-/Integrale}\label{2e-integrals-section}
Bei den Termen 
$\left[ \varphi_i \varphi_i \vert \varphi_j\varphi_j \right]$ und
$\left[ \varphi_i \varphi_j \vert \varphi_j\varphi_i \right]$
handelt es sich um 2\-/Elektronen\-/Integrale,
welche allgemein definiert sind als:

\begin{equation}\label{2e-integral}
  \left[ \varphi_i \varphi_j \vert \varphi_k \varphi_l \right] := 
  \int \varphi_i^*(1) \varphi_j(1) \frac{1}{r_{12}} \varphi_k^*(2) \varphi_l(2) \,d\tau_1 \,d\tau_2
\end{equation}

\cite[S. 19]{tc2_3}

\subsubsection*{Coulomb-Integral}
Das Coulomb\-/Integral $\left[ \varphi_i \varphi_i \vert \varphi_j\varphi_j \right]$
stellt die elektrostatische Abstoßung zwischen den Elektronen der Orbitale $\varphi_i$ und $\varphi_j$ dar:

\begin{equation}\label{coulomb}
\begin{aligned}
  \left[ \varphi_i \varphi_i \vert \varphi_j \varphi_j \right] &= 
  \int \varphi_i^*(1) \varphi_i(1) \frac{1}{r_{12}} \varphi_j^*(2) \varphi_j(2) \,d\tau_1 \,d\tau_2\\
  &= \int \varphi_i^*(1) \hat{J}_j \varphi_i(1) \,d\tau_1 \\ 
  &= \langle \varphi_i \vert \hat{J}_j \vert \varphi_i \rangle
\end{aligned}
\end{equation}

Der zugehörige Coulomb\-/Operator $\hat{J}_j$ ist definiert als:
\begin{equation}\label{coulomb-operator}
  \hat{J}_j \varphi_i(1):= 
  \int \varphi_j^*(2) \frac{1}{r_{12}} \varphi_j(2) \varphi_i(1) \,d\tau_2 
\end{equation}

Das Coulomb\-/Integral alleine überschätzt die elektrostatische Abstoßung zweier Orbitale,
weil im Integral\-/Bild Elektronen sich beliebig nahekommen können.
Dies ignoriert jedoch das Pauli-Ausschluss-Prinzip, 
welches zwei Elektronen mit identischen quantenmechanischen Zuständen ausschließt.
Dieses verstärkte Meiden der Elektronen wird auch Pauli-Repulsion genannt.

\cite[S. 206]{lewars_2016} \cite[S. 23]{tc2_3}

\subsubsection*{Austausch-Integral}
Aus der Slater\-/Determinante, welche das Pauli-Ausschluss-Prinzip erzwingt,
geht das Austausch\-/Integral $\left[ \varphi_i \varphi_j \vert \varphi_j\varphi_i \right]$ hervor.
Dieses Integral ist ein Korrektur\-/Term für die im Coulomb\-/Integral vernachlässigte Pauli\-/Repulsion.
Es ist gegeben durch:


\begin{equation}\label{exchange}
  \begin{aligned}
  \left[ \varphi_i \varphi_j \vert \varphi_j \varphi_i \right] &= 
  \int \varphi_i^*(1) \varphi_j(1) \frac{1}{r_{12}} \varphi_j^*(2) \varphi_i(2) \,d\tau_1 \,d\tau_2\\
  &= \int \varphi_i^*(1) \hat{K}_j \varphi_i(1) \,d\tau_1 \\ 
  &= \langle \varphi_i \vert \hat{K}_j \vert \varphi_i \rangle
\end{aligned}
\end{equation}

Der zugehörige Austausch\-/Operator $\hat{K}_j$ ist definiert als:
\begin{equation}\label{exchange-operator}
  \hat{K}_j \varphi_i(1) :=
  \int \varphi_j^*(2) \frac{1}{r_{12}} \varphi_j(1) \varphi_i(2) \,d\tau_2
\end{equation}

\cite[S. 206]{lewars_2016} \cite[S. 23]{tc2_3}

%================================================
%HERLEITUNG-HF
%================================================
\subsection{Herleitung der Hartree-Fock-Gleichungen}
Wir suchen nun nach einer Extremstelle für das Energie-Funktional $E_\textrm{HF}[\Psi]$ unter der Bedingung, 
dass die Spinorbitale orthonormal bleiben. 
Dafür werden im Folgenden Lagrange\-/Multiplikatoren in einem Variations\-/Verfahren verwendet.
Wir variieren beliebig im Bezug auf die Spinorbitale: 
\begin{equation}
\Psi \rightarrow \Psi + \delta \Psi
\text{, sodass alle } \varphi_i \rightarrow \varphi_i + \delta \varphi_i
\end{equation}

\subsubsection*{Energie}
Die Energie für die variierte Wellenfunktion ist dann:
\begin{equation}
\begin{aligned}
  E_\textrm{HF}[\Psi + \delta \Psi]
  &= \langle \Psi + \delta \Psi \vert \hat{H}_{\text{el}} \vert \Psi + \delta \Psi \rangle\\
  &= \langle \Psi \vert \hat{H}_{\text{el}} \vert \Psi \rangle +
  \underbrace{\langle \delta \Psi \vert \hat{H}_{\text{el}} \vert \Psi \rangle +
  \langle \Psi \vert \hat{H}_{\text{el}} \vert \delta \Psi \rangle}_\textrm{Erste Variation $\delta E_\textrm{HF}$} +
  \langle \delta \Psi \vert \hat{H}_{\text{el}} \vert \delta \Psi \rangle
\end{aligned}
\end{equation}
Mit
\begin{equation}
  \begin{split}
  \delta E_\textrm{HF} &= 
  \sum_i^{2n} \langle \delta \varphi_i \vert \hat{H}_{\text{core}} \vert \varphi_i \rangle
  + \frac{1}{2} \sum_{i, j}^{2n} \left( 
    \left[ \delta \varphi_i \varphi_i \vert \varphi_j \varphi_j \right]
  + \left[ \varphi_i \delta \varphi_i \vert \varphi_j \varphi_j \right]
  - \left[ \delta \varphi_i \varphi_j \vert \varphi_j \varphi_i \right]
  - \left[ \varphi_i \delta \varphi_j \vert \varphi_j \varphi_i \right]
  \right)\\
  &+ \sum_i^{2n} \langle \varphi_i \vert \hat{H}_{\text{core}} \vert \delta \varphi_i \rangle
  + \frac{1}{2} \sum_{i, j}^{2n} \left( 
    \left[ \varphi_i \varphi_i \vert \delta \varphi_j \varphi_j \right] 
  + \left[ \varphi_i \varphi_i \vert \varphi_j \delta \varphi_j \right]
  - \left[ \varphi_i \varphi_j \vert \delta \varphi_j \varphi_i \right]
  - \left[ \varphi_i \varphi_j \vert \varphi_j \delta \varphi_i \right]
  \right)
  \end{split}
\end{equation}
Dies vereinfacht zu
\begin{equation}\label{E_HF}
  \begin{split}
  \delta E_\textrm{HF} &=
  \sum_i^{2n} \langle \delta \varphi_i \vert \hat{H}_{\text{core}} \vert \varphi_i \rangle
  + \sum_{i, j}^{2n} \left( 
    \left[ \delta \varphi_i \varphi_i \vert \varphi_j \varphi_j \right]
  - \left[ \delta \varphi_i \varphi_j \vert \varphi_j \varphi_i \right]
  \right)\\
  &+ \underbrace{\left( \sum_i^{2n} \langle \delta \varphi_i \vert \hat{H}_{\text{core}} \vert \varphi_i \rangle
  + \sum_{i, j}^{2n} \left( 
    \left[ \delta \varphi_i \varphi_i \vert \varphi_j \varphi_j \right]
  - \left[ \delta \varphi_i \varphi_j \vert \varphi_j \varphi_i \right]
  \right)\right)^*}_\textrm{Komplexe Konjugation $\Theta_E$}\\
  &= 
  \sum_i^{2n} \langle \delta \varphi_i \vert \hat{H}_{\text{core}} \vert \varphi_i \rangle
  + \sum_{i, j}^{2n} \left( 
    \left[ \delta \varphi_i \varphi_i \vert \varphi_j \varphi_j \right]
  - \left[ \delta \varphi_i \varphi_j \vert \varphi_j \varphi_i \right]
  \right) + \Theta_E
  \end{split}
\end{equation}
Für eine Extremstelle muss diese erste Variation verschwinden, wir fordern:
\begin{equation}
  \delta E_\textrm{HF} \overset{!}{=} 0
\end{equation}

\subsubsection*{Orthonormalität}
Wir fordern ebenfalls, dass die Spinorbitale orthonormal bleiben:
\begin{equation}
  \langle \varphi_i \vert \varphi_j \rangle \overset{!}{=} \delta_{ij}\quad \forall i,j
\end{equation}

\subsubsection*{Lagrange Multiplikatoren}
Kombiniert man beide Forderungen mit Lagrange Multiplikatoren erhält man das Funktional:
\begin{equation}
  \mathcal{L}[\Phi] = E_\textrm{HF}[\Phi]
  - \sum_{i,j}^{2n} \lambda_{ij}(\langle \varphi_i \vert \varphi_j \rangle - \delta_{ij})
\end{equation}
Es gilt dabei $\lambda_{ij} = \lambda_{ji}^*$,
also die $\lambda_{ij}$ bilden eine hermitesche Matrix. \cite[3.40]{szabo_ostlund_1996}

Eine Extremstelle in $\mathcal{L}$ bedeutet auch eine Extremstelle in $E_\textrm{HF}$
unter der Orthonormalitäts\-/Bedingung. Also setzten wir die Erste Variation in $\mathcal{L}$ null:
\begin{equation}
  \delta \mathcal{L} = \delta E_\textrm{HF}
  - \sum^{2n}_{i,j} \lambda_{ij} \delta \langle \varphi_i \vert \varphi_j \rangle = 0
\end{equation}

Wir packen im Folgenden alle komplex konjugierten Terme in $\Theta$,
dabei gleicht das $\Theta^*$ stets dem restlichen Term.
\begin{align*}
  0 &= \delta E_\textrm{HF} 
  - \sum^{2n}_{i,j} \lambda_{ij} \delta \langle \varphi_i \vert \varphi_j \rangle\\
  &= \delta E_\textrm{HF}
  - \sum^{2n}_{i,j} \lambda_{ij} \langle \delta \varphi_i \vert \varphi_j \rangle
  - \sum^{2n}_{i,j} \lambda_{ij} \langle \varphi_i \vert \delta \varphi_j \rangle\\
  &= \delta E_\textrm{HF}
  - \sum^{2n}_{i,j} \lambda_{ij} \langle \delta \varphi_i \vert \varphi_j \rangle
  - \left(\sum^{2n}_{i,j} \lambda_{ji} \langle \delta \varphi_i \vert \varphi_j \rangle \right)^*
  &| &\textrm{ \cref{E_HF}}\\
  &=  \sum_i^{2n} \langle \delta \varphi_i \vert \hat{H}_{\text{core}} \vert \varphi_i \rangle
  + \sum_{i, j}^{2n} \left( 
    \left[ \delta \varphi_i \varphi_i \vert \varphi_j\varphi_j \right] 
    - \left[ \delta \varphi_i\varphi_j \vert \varphi_j\varphi_i \right]
  \right) 
  - \sum_{i,j}^{2n} \lambda_{ij} \langle \delta \varphi_i \vert \varphi_j \rangle + \Theta
  &| &\textrm{ \cref{coulomb}, \cref{exchange}}\\
  &=  \sum_i^{2n} \langle \delta \varphi_i \vert \hat{H}_{\text{core}} \vert \varphi_i \rangle
  + \sum_{i, j}^{2n} \left( 
    \langle \delta \varphi_i \vert \hat{J}_j \vert \varphi_i \rangle
    - \langle \delta \varphi_i \vert \hat{K}_j \vert \varphi_i \rangle
  \right) 
  - \sum_{i,j}^{2n} \lambda_{ij} \langle \delta \varphi_i \vert \varphi_j \rangle + \Theta
\end{align*}

Wir faktorisiern nun die Summe $\sum_i^{2n}$ und das $\langle \delta \varphi_i \vert$ aus:
\begin{equation*}
  \sum_i^{2n} \langle \delta \varphi_i \vert \left(
    \hat{H}_{\text{core}} \vert \varphi_i \rangle
  + \sum_j^{2n} \left(
    \hat{J}_j \vert \varphi_i \rangle
    - \hat{K}_j \vert \varphi_i \rangle
  \right) 
  - \sum_j^{2n}\lambda_{ij} \vert \varphi_j \rangle \right) + \Theta
  = 0
\end{equation*}

Da jedes $\delta \varphi_i^*$ beliebig variiert werden kann,
muss der Term in der Klammer für jedes $i$ jeweils null sein für eine Nullstelle.
Wir erhalten die Hartree\-/Fock\-/Gleichungen:
\begin{equation}
  \left(\hat{H}_{\text{core}} + \sum_j^{2n} 
  \left( \hat{J}_j - \hat{K}_j \right)\right)\vert\varphi_i\rangle = 
  \sum_j^{2n}\lambda_{ij} \vert\varphi_j\rangle, \quad \forall i = 0 \dots 2n\nonumber
\end{equation}
Kurz als:
\begin{equation}
  \hat{F}\varphi_i = \sum_j^{2n}\lambda_{ij} \varphi_j, \quad \forall i = 0 \dots 2n
\end{equation}

Durch Matrix-Diagonalisierung erhält man die kanonischen Hartree\-/Fock\-/Gleichungen:
\begin{equation} \label{UHF}
  \hat{F} \varphi_i' = \lambda_i \varphi_i', \quad i = 0 \dots 2n
\end{equation}
Da die $\lambda_{ij}$ hermitesch sind, ist immer eine Matrix\-/Diagonalisierung möglich.
Dabei ist der Fock\-/Operator $\hat{F}$ invariant bezüglich dieser Diagonalisierung
\cite[3.64]{szabo_ostlund_1996}.

\cite[S. 253]{atkins_friedman_2011}
\cite[S. 115-119]{szabo_ostlund_1996}

%================================================
%SPIN-AUSINTEGRIEREN
%================================================
\subsection{Entfernen des Spins}
Es ist möglich den Spin aus unserer Hatree\-/Fock\-/Gleichung zu entfernen,
da wir lediglich Möleküle betrachten,
deren Orbitale stets zweifach besetzt sind mit je einem $\alpha$ und $\beta$ Elektron.
Wir müssen nur für ein beliebiges $\varphi_i$ aus \cref{UHF} umformen:
\begin{align*}
  \hat{F} \varphi_i &= \lambda_i \varphi_i \\
  \hat{F} \psi_i \alpha &= \lambda_i \psi_i \alpha
\end{align*}

Wir integrieren nun beide Seiten der Gleichung,
multipliziert mit $\alpha^*$, über die Spinkoordinate $\omega$.
Wir multiplizieren mit $\langle \alpha \vert$:
\begin{align*}
  \langle \alpha \vert \hat{F} \psi_i \vert \alpha \rangle &= 
  \langle \alpha \vert\lambda_i \psi_i \vert \alpha \rangle\\
  \langle \alpha \vert \left(\hat{H}_{\text{core}} + \sum_j^{2n} 
  \left( \hat{J}_j - \hat{K}_j \right)\right) \psi_i \vert \alpha \rangle &= 
  \langle \alpha \vert \lambda_i \psi_i \vert \alpha \rangle
\end{align*}

$\hat{H}_{\text{core}}, \psi_i$ und $\lambda_i$ sind von den Spinkoordinaten unabhängig und
können außerhalb der Spin-Integrale stehen:
\begin{align}
  \hat{H}_{\text{core}} \psi_i \underbrace{\langle \alpha \vert \alpha \rangle}_{=1} +
  \langle \alpha \vert \sum_j^{2n} 
  \left( \hat{J}_j - \hat{K}_j \right) \vert \alpha \rangle \psi_i 
  &= \lambda_i \psi_i \underbrace{\langle \alpha \vert \alpha \rangle}_{=1} \nonumber\\
  \hat{H}_{\text{core}} \psi_i + \langle \alpha \vert \sum_j^{2n}
  \left( \hat{J}_j - \hat{K}_j \right) \vert \alpha \rangle \psi_i 
  &= \lambda_i \psi_i
\end{align}

Wir definieren spinunabhängige Versionen des Coulomb- und Austausch\-/Operators
aus \cref{coulomb-operator} und \cref{exchange-operator},
die im nächsten Schritt verwendet werden:
\begin{equation}\label{spinless-coulomb-operator}
    \hat{J}'_j \psi_i(1):= 
    \int \psi_j^*(2) \frac{1}{r_{12}} \psi_j(2) \psi_i(1) \,d\nu_2 
\end{equation}
\begin{equation}\label{spinless-exchange-operator}
    \hat{K}'_j \psi_i(1) :=
  \int \psi_j^*(2) \frac{1}{r_{12}} \psi_j(1) \psi_i(2) \,d\nu_2
\end{equation}
Man merke:
\begin{equation}
    \hat{J}_j = \begin{cases}
        \langle \alpha \vert \hat{J}'_j \vert \alpha \rangle\\
        \langle \beta \vert \hat{J}'_j \vert \beta \rangle
    \end{cases}\quad
    \hat{K}_j = \begin{cases}
        \langle \alpha \vert \hat{K}'_j \vert \alpha \rangle\\
        \langle \beta \vert \hat{K}'_j \vert \beta \rangle
    \end{cases}
\end{equation}

Betrachten wir nun den Term für die Elektron\-/Elektron\-/Interaktionen.
Da im Coulomb- und Austausch\-/Operator Spin\-/Orbital\-/Funktion vorkommen und
jedes Orbital zwei Elektronen mit unterschiedlichem Spin enthält, lässt sich die Summe umschreiben zu:
\begin{align*}
  \langle \alpha \vert \sum_j^{2n} \left( \hat{J}_j - \hat{K}_j \right) \vert \alpha \rangle
  &= \sum_j^{2n} \langle \alpha \vert \hat{J}_j \vert \alpha \rangle
  - \langle \alpha \vert \hat{K}_j \vert \alpha \rangle \\
  &= \sum_j^{n} 
  \langle \alpha(1) \vert \langle \alpha(2) \vert \hat{J'}_j \vert \alpha(2) \rangle \vert \alpha(1) \rangle
  + \langle \alpha(1) \vert \langle \beta(2) \vert \hat{J'}_j \vert \beta(2) \rangle \vert \alpha(1) \rangle\\
  &- \langle \alpha(1) \vert \langle \alpha(2) \vert \hat{K'}_j \vert \alpha(1) \rangle \vert \alpha(2) \rangle
  - \langle \alpha(1) \vert \langle \beta(2) \vert \hat{K'}_j \vert \beta(1) \rangle \vert \alpha(2) \rangle
\end{align*}
Wir haben die Terme der Summe mit gleichem Raumorbital kombiniert und
das Spin\-/Integral der Operatoren aus diesen herausgezogen,
siehe \cref{2e-integrals} für die Definition der Operatoren.
Also hängen die modifizierten Operatorn $\hat{J'}_j$ und $\hat{K'}_j$ nicht von $\omega_1$ oder $\omega_2$ ab,
wir können die Operatoren aus den Spin\-/Integralen entfernen:
\begin{align*}
  &=\sum_j^{n} 
  \hat{J'}_j \langle \alpha(1) \vert \langle \alpha(2) \vert \alpha(2) \rangle \vert \alpha(1) \rangle
  + \hat{J'}_j \langle \alpha(1) \vert \langle \beta(2) \vert \beta(2) \rangle \vert \alpha(1) \rangle\\
  &- \hat{K'}_j \langle \alpha(1) \vert \langle \alpha(2) \vert \alpha(1) \rangle \vert \alpha(2) \rangle
  - \hat{K'}_j \langle \alpha(1) \vert \langle \beta(2) \vert \beta(1) \rangle \vert \alpha(2) \rangle\\
  &=\sum_j^{n} 
  \hat{J'}_j \underbrace{\langle \alpha(1) \vert \alpha(1) \rangle}_{=1}
  \underbrace{\langle \alpha(2) \vert \alpha(2) \rangle}_{=1}
  + \hat{J'}_j \underbrace{\langle \alpha(1) \vert \alpha(1) \rangle}_{=1}
  \underbrace{\langle \beta(2) \vert \beta(2) \rangle}_{=1}\\
  &- \hat{K'}_j \underbrace{\langle \alpha(1) \vert \alpha(1) \rangle}_{=1}
  \underbrace{\langle \alpha(2) \vert \alpha(2) \rangle}_{=1}
  - \hat{K'}_j \underbrace{\langle \alpha(1) \vert \beta(1) \rangle}_{=0}
  \underbrace{\langle \beta(2) \vert \alpha(2) \rangle}_{=0}
  =\sum_j^{n} 2\hat{J'}_j - \hat{K'}_j
\end{align*}

Setzen wir den letzten Term wieder in die urspüngliche Gleichung ein, erhalten wir:
\begin{equation}
  \underbrace{\left( \hat{H}_{\text{core}} + \sum_j^{n}
  \left( 2\hat{J'}_j - \hat{K'}_j \right) \right)}_{\hat{F}'} \psi_i 
  = \lambda_i \psi_i
\end{equation}

Dies gilt analog zu einem $\varphi_i$ mit $\beta$ Spin und damit auch für alle $i$:
\begin{equation}\label{RHF}
  \hat{F}' \psi_i = \lambda_i \psi_i\quad \forall i
\end{equation}

Das ist die Hartree\-/Fock\-/Gleichung unter der Bedingung, dass jedes Orbital doppelt besetzt ist.
Diesen Fall \cref{RHF} nennt man Restricted Hartree\-/Fock (RHF) und
den Fall mit Spin\-/Orbitalen aus \cref{UHF} Unrestricted Hartree\-/Fock (UHF).

Wir beschränken uns nur auf Restricted Hartree\-/Fock, wie bereits festgelegt.

%================================================
%ROOTHAAN-HALL
%================================================
\section{Roothaan-Hall}
\subsection{Aufstellung der Gleichungen}
Um die RHF\-/Gleichungen zu lösen, benötigen wir nur noch einen klaren Ausdruck für die $\psi_i$.
Da die $\psi_i$ Molekül\-/Orbitale darstellen, welche sehr unterschiedlich aufgebaut sein können,
werden diese als Linearkombination von $m$ Atom\-/Orbitalen $\chi_s$ repräsentiert:
\begin{equation}\label{lin-comb-atomorbitals}
  \psi_i = \sum_s^m C_{s i} \chi_s \quad \forall i 
\end{equation}

Wir setzen diese Darstellung in die RHF\-/Gleichung \cref{RHF} ein und
erhalten die Roothaan\-/Hall\-/Gleichungen:
\begin{equation}\label{roothaan_hall_eq}
  \sum_s^m \hat{F}' C_{s i} \chi_s = \lambda_i \sum_s^m C_{s i} \chi_s 
\end{equation}

Wir haben nun $n$ dieser Gleichungen, je eine für jedes besetzte Raum\-/Orbital $\psi_i$.
Wir stellen nun $n'$ weitere Gleichungen auf, sodass $n + n' = m$ ist.
Wir erhalten dann $n'$ ''virtuelle'' Raum\-/Orbitale, welche keine Elektronen enthalten und
nicht in der Slater\-/Determinante auftauchen.
Durch diese Erweiterung bringen wir die Gleichungen in eine Form,
die sich leicht in eine Matrix\-/Gleichung mit $m\times m$ Matrizen umformen lässt.

Wir definieren die $m\times m$ Matrizen $F$ und $S$ mit den Elementen:
\begin{equation}\label{rh_mtx_elements}
  \begin{aligned}
    F_{r s} &:= \langle \chi_r \vert \hat{F}' \vert \chi_s \rangle\\
    S_{r s} &:= \langle \chi_r \vert \chi_s \rangle
  \end{aligned}
\end{equation}

Es lässt sich zeigen, dass man \cref*{roothaan_hall_eq} in diese Matrix\-/Form bringen kann:
\begin{equation} \label{roothaan_mtx}
  FC = SC\lambda
\end{equation}

\subsection{Lösung der Matrix\-/Gleichung}
Die Matrizen $F$ und $S$ können nun über \cref{rh_mtx_elements} berechnet werden,
sodass wir nur noch die Koeffizienten\-/Matrix und diagonale Energie\-/Matrix als die Unbekannten haben.

Mit der genauen Evaluierung der Matrizen $F$ und 
$S$ befassen wir uns in \cref{F_S_mtx_calc}.
Wir nehmen deshalb zunächst an,
dass wir immer konkrete Werte für die beiden Matrizen berechnen können.

Bei näherer Betrachtung fällt auf, dass wir eine simple Eingewertsgleichung erhalten,
wenn die Überlappmatrix $S$ aus \cref{roothaan_mtx} verschwindet:
\begin{align*}
    FC &= C\lambda \quad \vert \cdot C^{-1}\\
    F &= C\lambda C^{-1}
\end{align*}

Da $S$ hermitesch ist, existiert eine unitäre Matrix $U$, welche $S$ diagonalisieren kann:
\begin{equation}
    S = U s U^\dagger
\end{equation}

Wir konstruieren nun mit Hilfe der Matrizen $U$ und $s$ eine Transformations\-/Matrix $S^{-1/2}$:
\begin{equation}
    S^{-1/2} = U s^{-1/2} U^\dagger
\end{equation}
Wir erhalten $s^{-1/2}$, indem die inverse Wurzel für jeden Diagonal\-/Eintrag in $s$ gezogen wird.

Es gilt nun:
\begin{equation}
    S^{-1/2} S S^{-1/2} = S^{-1/2} S^{1/2} = S^{0} = \mathbf{1}
\end{equation}

Man kann mit $S^{-1/2}$ die Koeffizienten transformieren:
\begin{equation}\label{trans_C}
    C = S^{-1/2} C'
\end{equation}
Setzen wir \cref{trans_C} in \cref{roothaan_mtx} ein und multiplizieren $S^{-1/2}$ von links,
können wir unsere Gleichung aus \cref{roothaan_mtx} umschreiben zu:
\begin{equation}
    \begin{aligned}
    \underbrace{S^{-1/2}FS^{-1/2}}_{F'}C' &= \underbrace{S^{-1/2}SS^{-1/2}}_{\mathbf{1}}C'\lambda\\
    F'C' &= C'\lambda\\
    F'&= C'\lambda C'^{-1}
    \end{aligned}
\end{equation}

Man muss nur noch die transformierte Fock\-/Matrix $F'$ diagonalisieren und 
die erhaltenen Koeffizienten über \cref{trans_C} in die ursprüngliche Basis transformieren.

Die erhaltenen Eigenwerte $\lambda$ entsprechen den Energien der Orbitale,
welche durch die Koeffizienten in $C$ beschrieben werden.

\cite[S. 142-145]{szabo_ostlund_1996}

\subsection{Berechnung der Molekül\-/Orbitale und Orbital\-/Energien}
Wir können nun die Matrix\-/Gleichung \cref{roothaan_mtx} lösen,
jedoch handelt es sich um eine nicht lineare Gleichung, weil die Fock\-/Matrix $F$
von den Raumorbitalen $\varphi_i$ und damit auch von den Koeffizienten in $C$ abhängt.

Wir möchten also die Koeffizienten\-/Matrix $C$ berechnen,
benötigen aber dafür die Fock\-/Matrix $F$, die wir nur erhalten können,
wenn wir $C$ bereits berechnet haben.

Dieses Hindernis überwältigen wir,
indem wir diese Gleichung in einem iterativen Verfahren lösen:
\begin{enumerate}
    \item Wir beginnen mit einer hoffentlich guten Schätzung
    für die Koeffizienten\-/Matrix $C$ bzw. den Raumorbitalen $\varphi_i$.
    \item Dann lösen wir die Gleichung \cref{roothaan_mtx} mit der neusten Schätzung
    für $C$ und aktualisieren unsere Schätzung
    für die Koeffizienten\-/Matrix $C$ mit der Lösung.
    \item Wir wiederholen den 2. Schritt solange, bis die Koeffizienten\-/Matrix $C$
    keine signifikanten Veränderungen aufweist. Die Koeffizienten\-/Matrix $C$
    und die Energien $\lambda$ aus der letzten Iteration stellen die Ergebnisse
    unseres Verfahrens. 
\end{enumerate}

Dieses Verfahren wird die Self\-/Consistent Field method (kurz SCF) genannt,
da wir erst aufhören, wenn die Koeffizienten\-/Matrix $C$
über mehrere Iterationen hinweg gleich bleibt, also mit sich selbst konsistent ist.\\

\input{sections/scf_chart.tex}
\subsection{Darstellung des Fock\-/Operators in der Atomorbital\-/Basis}\label{F_S_mtx_calc}

Wir müssen noch die Fock\-/Matrix $F$ und Überlapp\-/Matrix $S$ berechnen,
um die Gleichung \cref{roothaan_mtx} zu lösen.

Die Berechnung der Überlapp\-/Matrix $S$ ist durch \cref{rh_mtx_elements} bereits vollständig
als Integrale über Atomorbitale gegeben.
Die Elemente der Fock\-/Matrix $F$ hingegen benötigen den Fock\-/Operator $\hat{F}'$,
welcher selber von den Molekülorbitalen abhängt.
Der UHF Fock\-/Operator $\hat{F}'$ wurde bereits definiert als:
\begin{equation}
    \hat{F}' = \hat{H}_{\text{core}} + \sum_j^{n}
    \left( 2\hat{J'}_j - \hat{K'}_j \right)
\end{equation}
Dabei hängen die Coulomb- und Austausch\-/Operatoren $\hat{J'}_j$, $\hat{K'}_j$
von Molekül\-/Raumorbitalen $\psi_j$ ab.
Setzt man die Atomobitale $\chi_s$ aus \cref{lin-comb-atomorbitals} in
die Definitionen von $\hat{J'}_j$\cref{spinless-coulomb-operator} und
$\hat{K'}_j$ \cref{spinless-exchange-operator} ein, lässt sich $F_{r s}$ schreiben als:
\begin{equation}
    F_{rs} = \langle \chi_r \vert \hat{F}' \vert \chi_s \rangle
    = \langle \chi_r \vert \hat{H}_{\text{core}} \vert \chi_s \rangle
    + \sum_{tu}^m \sum_j^{n} C_{tj}^*C_{uj}\left( 2[rs\vert tu] - [ru\vert ts] \right)
\end{equation}
Die 2\-/Elektronen\-/Integrale $[rs\vert tu]$ und $[ru\vert ts]$
sind analog zu \cref{2e-integral} definiert, wobei es sich um Atomorbitale handelt ohne Spin.

In dieser Form müssen die 2\-/Elektronen\-/Integrale nur einmal
zu Beginn für einen Satz Atomorbitale berechnet werden und
können dann in jeder Iteration wieder verwendet werden,
da sich nur noch die Koeffizienten\-/Matrix $C$ in jeder Iteration ändern kann.

Zur Berechnung der Fock\-/Matrix $F$ und Überlapp\-/Matrix $S$
fehlen uns nur noch explizite Terme für die Atomorbitale $\chi$.
Diese sind Implementierungsabhängig und werden deshalb im nächsten Kapitel
unter \cref{basis-functions-section} behandelt.

\subsection{Berechnung der Gesamtenergie des Moleküls}
Ab diesem Punkt sind wir in der Lage die Molekülorbitale und
deren Eigen\-/Energien zu Berechnen. Um die Gesamtenergie des Moleküls zu erhalten,
müssen die Orbitalenergien kombiniert werden:
\begin{equation}
    E_{\text{HF}} = 2 \sum_i^n \lambda_i - \sum_i^n \sum_j^n
    2 \langle \psi_i \vert \hat{J}_j \vert \psi_i \rangle
    - \langle \psi_i \vert \hat{K}_j \vert \psi_i \rangle
\end{equation}
Wir zählen alle Orbital\-/Energien doppelt, da wir insgesamt $2n$ Elektronen haben.
Durch die Summe der Orbital\-/Energien werden die Elektron\-/Repulsions\-/Terme
jedoch zu oft gezählt, weil ein Repulsions\-/Term immer zwischen zwei Orbitalen wirkt.
Also wir würden die Repulsion zb. des Orbitals $\psi_i$ mit $\psi_j$ und umgekehrt zählen,
was zu oft ist.
Deshalb werden einmal zur Korrektur die Repulsion von den Orbitalenergien abgezogen.
Die Gleichung kann man weiter umformen zu:
\begin{equation}
    E_{\text{HF}} = \sum_i^n \lambda_i
    + \sum_i^n \langle \psi_i \vert \hat{H}_{\text{core}} \vert \psi_i \rangle
    = \sum_i^n \lambda_i
    + \sum_{rs}^m \sum_i^{n} C_{ri}^*C_{si}
    \langle \chi_r \vert \hat{H}_{\text{core}} \vert \chi_s \rangle
\end{equation}

\cite[S. 229-230]{lewars_2016}



